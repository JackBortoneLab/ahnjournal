{% extends "admin/core/base.html" %}}
{% load foundation %}
{% load static from staticfiles %}
{% load materialize %}

{% block title %}Edit Metadata - {{ article.pk }}{% endblock title %}


{% block breadcrumbs %}
    {{ block.super }}
    <li>Edit</li>
    <li>{{ article.title|safe }}</li>
    <li>Metadata</li>
{% endblock breadcrumbs %}

{% block body %}
    <div class="large-12 columns box">
        <div class="row expanded">
            <form method="POST"{% if journal_settings.general.abstract_required %} novalidate{% endif %}>
                <div class="title-area">
                    <h2>Edit Article Metadata</h2>
                    <a class="small btn float-right" href="{{ return }}"><i class="fa fa-arrow-left"></i>Back</a>
                </div>
                <div class="content">
                    {% include "elements/forms/errors.html" with form=info_form %}
                    
                    {% materialize_form form=info_form %}

                    <div class="large-12 columns">
                        <button type="submit" name="metadata" class="small success btn">Update Article Metadata</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
    {% include "admin/elements/submission/edit_author.html" %}
{% endblock body %}


{% block js %}
    <!-- Messy code generated by Andy et al -->
    {% if modal %}
        {% include "admin/elements/open_modal.html" with target=modal %}
    {% endif %}
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.11.0/themes/smoothness/jquery-ui.css">
    <script type="text/javascript" src="{% static "common/js/jq-ui.min.js" %}"></script>
    <script src="{% static "common/js/tagit.js" %}"></script>

    <script type="text/javascript">
        $("#id_keywords").tagit({allowSpaces: true});
        $("#sortable").sortable({
            update: function (event, ui) {
                var data = $(this).sortable('serialize');
                //console.log(data);
                // POST to server using $.post or $.ajax
                $.ajax({
                    data: data,
                    type: 'POST',
                    url: '{% url 'order_authors' article.pk %}'
                });
            }
        });
        $('select').formSelect();
        //$("#sortable").disableSelection();
    </script>
    {% include "elements/jqte.html" %}
    {% include 'elements/fundref/fundref.html' %}
{% endblock js %}
